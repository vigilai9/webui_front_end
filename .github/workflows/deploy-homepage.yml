name: Deploy to cPanel

on:
  push:
    branches: [ home_page ] # or your production branch

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18' # or your preferred version

    - name: Install dependencies
      run: npm install

    - name: Install dependencies
      run: npm install

    - name: Build project
      run: npm run build

    - name: Zip build output
      run: |
        cd out # or your build output directory
        zip -r ../out.zip .
    
    - name: Create home_page directory
      uses: appleboy/ssh-action@master
      with:
        host: 's3cura.ai'
        username: 'iqfu27x9dob7'
        password: 'Gaurav123#'
        port: 22
        script: |
          mkdir -p /home/iqfu27x9dob7/public_html/home_page


    # - name: Upload and Extract ZIP
    #   uses: appleboy/ssh-action@master
    #   with:
    #    host: 's3cura.ai'
    #    username: 'iqfu27x9dob7'
    #    password: 'Gaurav123#'
    #    port: 22
    #    script: |
    #     # Upload the file using SCP
    #     scp -o StrictHostKeyChecking=no -r out.zip iqfu27x9dob7@s3cura.ai:/home/iqfu27x9dob7/public_html/home_page